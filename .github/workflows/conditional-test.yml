name: Conditional Jobs Demo

on:
  workflow_dispatch: # Allows manual testing
    inputs:
      run_tests:
        description: "Run tests? (yes/no)"
        required: true
        default: "yes"
      deploy_env:
        description: "Environment to deploy (dev/prod/none)"
        required: true
        default: "none"

jobs:
  check-input:
    runs-on: self-hosted
    steps:
      - name: Show inputs
        run: |
          echo "Run tests: ${{ github.event.inputs.run_tests }}"
          echo "Deploy env: ${{ github.event.inputs.deploy_env }}"

  tests:
    runs-on: self-hosted
    needs: check-input
    if: ${{ github.event.inputs.run_tests == 'yes' }} # Only run if input is yes
    steps:
      - name: Run test suite
        run: echo "âœ… Tests are running!"

  deploy-dev:
    runs-on: self-hosted
    needs: [check-input, tests]
    if: ${{ github.event.inputs.deploy_env == 'dev' }}
    steps:
      - name: Deploy to Dev
        run: echo "ðŸš€ Deploying to Development Environment"

  deploy-prod:
    runs-on: self-hosted
    needs: [check-input, tests]
    if: ${{ github.event.inputs.deploy_env == 'prod' && github.event.inputs.run_tests == 'yes' }}
    steps:
      - name: Deploy to Production
        run: echo "ðŸš€ Deploying to Production Environment"
